# è®­ç»ƒè¾“å‡ºæ–‡ä»¶è¯´æ˜

è¿è¡Œ `train_face.py` åä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ç»“æ„ï¼š

```
scripts/
â”œâ”€â”€ ğŸ“ checkpoints/           # æ¨¡å‹æƒé‡æ–‡ä»¶
â”‚   â””â”€â”€ face_recognition/
â”‚       â”œâ”€â”€ best_model.pth          # â­ æœ€ä½³æ¨¡å‹ï¼ˆå‡†ç¡®ç‡æœ€é«˜ï¼‰
â”‚       â”œâ”€â”€ last_model.pth         # æœ€åä¸€æ¬¡ä¿å­˜çš„æ¨¡å‹
â”‚       â””â”€â”€ epoch_10_model.pth     # ç¬¬10è½®çš„æ¨¡å‹
â”‚
â”œâ”€â”€ ğŸ“ logs/                  # è®­ç»ƒæ—¥å¿—
â”‚   â””â”€â”€ face_recognition/
â”‚       â”œâ”€â”€ training.log            # è®­ç»ƒè¿‡ç¨‹æ—¥å¿—
â”‚       â””â”€â”€ events.out.tfevents     # TensorBoard æ—¥å¿—ï¼ˆå›¾è¡¨ç”¨ï¼‰
â”‚
â””â”€â”€ ğŸ“ visualization_results/  # å¯è§†åŒ–ç»“æœ
    â””â”€â”€ face_recognition/
        â”œâ”€â”€ accuracy_curve.png      # å‡†ç¡®ç‡æ›²çº¿
        â”œâ”€â”€ loss_curve.png          # æŸå¤±æ›²çº¿
        â””â”€â”€ confusion_matrix.png     # æ··æ·†çŸ©é˜µ
```

---

## ğŸ“ æ–‡ä»¶ä½œç”¨è¯¦è§£

### 1. checkpoints/ æ¨¡å‹æƒé‡ï¼ˆæœ€é‡è¦ï¼ï¼‰

| æ–‡ä»¶ | ä½œç”¨ | ä½•æ—¶ä½¿ç”¨ |
|------|------|---------|
| `best_model.pth` | éªŒè¯é›†å‡†ç¡®ç‡æœ€é«˜çš„æ¨¡å‹ | â­ æ­£å¼ä½¿ç”¨æ—¶åŠ è½½è¿™ä¸ª |
| `last_model.pth` | æœ€åä¸€ä¸ªepochçš„æ¨¡å‹ | æ¢å¤è®­ç»ƒæ—¶ç”¨ |
| `epoch_XX_model.pth` | æŸä¸€è½®çš„æ¨¡å‹ | å®éªŒåˆ†æç”¨ |

**pthæ–‡ä»¶é‡Œä¿å­˜äº†ä»€ä¹ˆï¼š**
```python
{
    'epoch': 10,                    # è®­ç»ƒåˆ°ç¬¬10è½®
    'model_state_dict': {...},      # æ¨¡å‹å‚æ•°ï¼ˆæƒé‡ï¼‰
    'optimizer_state_dict': {...}, # ä¼˜åŒ–å™¨çŠ¶æ€
    'accuracy': 0.98,              # éªŒè¯é›†å‡†ç¡®ç‡
    'loss': 0.05,                  # éªŒè¯é›†æŸå¤±
    'class_to_idx': {...}           # ç±»åˆ«æ˜ å°„è¡¨
}
```

---

### 2. logs/ è®­ç»ƒæ—¥å¿—

| æ–‡ä»¶ | ä½œç”¨ | æŸ¥çœ‹æ–¹å¼ |
|------|------|---------|
| `training.log` | æ–‡å­—æ—¥å¿— | ç›´æ¥æ‰“å¼€æŸ¥çœ‹ |
| `events.out.tfevents` | TensorBoardæ•°æ® | ç”¨ `tensorboard --logdir logs` æŸ¥çœ‹ |

**training.log ç¤ºä¾‹ï¼š**
```
2026-02-08 10:30:15 - Epoch 1/50
2026-02-08 10:30:16 - Train Loss: 0.85, Train Acc: 0.65
2026-02-08 10:30:20 - Val Loss: 0.45, Val Acc: 0.85
2026-02-08 10:30:21 - Saved best model: best_model.pth (Acc: 0.85)
...
```

---

### 3. visualization_results/ å¯è§†åŒ–å›¾è¡¨

| æ–‡ä»¶ | ä½œç”¨ |
|------|------|
| `accuracy_curve.png` | ğŸ“ˆ å‡†ç¡®ç‡å˜åŒ–æ›²çº¿ï¼ˆè®­ç»ƒ vs éªŒè¯ï¼‰ |
| `loss_curve.png` | ğŸ“‰ æŸå¤±å˜åŒ–æ›²çº¿ |
| `confusion_matrix.png` | ğŸ”¢ æ··æ·†çŸ©é˜µï¼ˆçœ‹å“ªäº›ç±»åˆ«å®¹æ˜“åˆ†é”™ï¼‰ |

---

## ğŸ”„ æ–‡ä»¶ç”Ÿå‘½å‘¨æœŸ

```
å¼€å§‹è®­ç»ƒ
    â”‚
    â–¼
ç”Ÿæˆ .log  â”€â”€â–º æŸ¥çœ‹è®­ç»ƒè¿‡ç¨‹
    â”‚
    â–¼
æ¯ epoch ä¿å­˜ â—„â”€â”€ æ–­ç‚¹ç»­è®­
    â”‚
    â–¼
å‘ç° best.pth  â—„â”€â”€ â­ ä¿å­˜æœ€ä½³æ¨¡å‹
    â”‚
    â–¼
è®­ç»ƒå®Œæˆ
    â”‚
    â–¼
å¯è§†åŒ–å›¾è¡¨ â”€â”€â–º åˆ†æç»“æœ
```

---

## ğŸ“Œ ä½¿ç”¨å»ºè®®

**1. è®­ç»ƒæ—¶ï¼š** å…³æ³¨ `logs/training.log` çœ‹å®æ—¶è¿›åº¦

**2. è®­ç»ƒåï¼š**
- ç”¨ `checkpoints/face_recognition/best_model.pth` åšæµ‹è¯•/æ¨ç†
- çœ‹ `visualization_results/` çš„å›¾è¡¨åˆ†ææ˜¯å¦è¿‡æ‹Ÿåˆ

**3. æƒ³å¤ç°å®éªŒï¼š**
- è®°å½• `experiment_name` å’Œ `best_model.pth` è·¯å¾„
- configæ–‡ä»¶è®°å½•æ‰€æœ‰å‚æ•°

---

## â“ å¸¸è§é—®é¢˜

**Q: å¯ä»¥åˆ é™¤æ—§æ–‡ä»¶å—ï¼Ÿ**
A: å¯ä»¥åˆ é™¤ `logs/` å’Œ `visualization_results/`ï¼Œä½† `checkpoints/` å»ºè®®ä¿ç•™

**Q: pthæ–‡ä»¶èƒ½ç›´æ¥æ‰“å¼€çœ‹å—ï¼Ÿ**
A: éœ€è¦ç”¨PythonåŠ è½½ï¼š
```python
import torch
ckpt = torch.load('best_model.pth')
print(ckpt.keys())
```

**Q: è®­ç»ƒä¸­æ–­èƒ½ç»§ç»­å—ï¼Ÿ**
A: å¯ä»¥ï¼åŠ è½½ `last_model.pth` çš„ `model_state_dict` å’Œ `optimizer_state_dict`
