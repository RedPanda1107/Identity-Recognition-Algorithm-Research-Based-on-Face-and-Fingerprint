# 多模态人脸+指纹融合识别配置文件
# 专为毕业论文多模态融合实验设计 (300人版本)

# 训练配置
training:
  epochs: 50
  batch_size: 32
  learning_rate: 0.001  # 融合模型使用较低的学习率
  weight_decay: 5e-4
  momentum: 0.9
  scheduler_step: 20
  scheduler_gamma: 0.1

# 模型配置（多模态融合）
model:
  # 人脸分支配置
  face_model_type: 'facenet'
  face_embedding_dim: 512
  face_pretrained: true  # 加载预训练权重

  # 指纹分支配置
  fingerprint_model_type: 'fingerprint_net'
  fingerprint_embedding_dim: 256
  fingerprint_pretrained: true  # 加载预训练权重

  # 融合层配置
  fusion_method: 'concat'  # 'concat', 'attention_fusion', 'cross_attention', 'tensor_fusion'
  fusion_hidden_dim: 512
  fusion_dropout_rate: 0.3

  num_classes: 300  # 300人

# 数据配置
data:
  face_image_size: 224
  fingerprint_image_size: 224
  use_augmentation: true
  augmentation:
    random_horizontal_flip: true
    random_rotation: 10
    color_jitter: true
    random_crop: false
    random_resized_crop: true
    random_erasing_prob: 0.2

# 路径配置
paths:
  data_dir: './data'
  face_data_dir: './data/face/face'
  fingerprint_data_dir: './data/fingerprint/fingerprint/organized'
  mapping_file: './data/face_fingerprint_mapping.json'
  checkpoint_dir: './checkpoints/fusion'
  log_dir: './logs/fusion'
  config_dir: './configs'
  results_dir: './results/fusion'

# 其他配置
misc:
  seed: 42
  num_workers: 4
  save_freq: 5
  log_freq: 10
  use_amp: true
  experiment_name: 'fusion_300persons'  # 300人融合实验
  early_stopping: true
  early_stopping_patience: 10

# 实验配置
experiment:
  ablation_study: false
  test_time_augmentation: false
  save_features: true  # 保存特征向量用于分析
  evaluate_every_epoch: true

  # 融合特有实验设置
  modality_ablation: true  # 开启模态消融实验
  face_only: false
  fingerprint_only: false

# 调试配置
debug:
  debug_mode: false
  max_samples: null
  log_images: false
